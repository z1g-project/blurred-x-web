{"version":3,"file":"static/js/235.94509793.chunk.js","mappings":"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","sources":["webpack://website/./src/RammerheadAPI.ts","webpack://website/./node_modules/js-cookie/dist/js.cookie.mjs","webpack://website/./src/pages/compat/rammerhead.tsx"],"sourcesContent":["export class RammerheadAPI {\n\tprivate server: string;\n\tprivate signal?: AbortSignal;\n\tprivate password?: string;\n\tconstructor(server: string, signal?: AbortSignal, password?: string) {\n\t\tthis.server = server;\n\t\tthis.signal = signal;\n\t\tthis.password = password;\n\t}\n\tasync get(url: string) {\n\t\tif (this.password) {\n\t\t\t// really cheap way of adding a query parameter\n\t\t\tif (url.includes('?')) {\n\t\t\t\turl += '&pwd=' + this.password;\n\t\t\t} else {\n\t\t\t\turl += '?pwd=' + this.password;\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tconst request = await fetch(new URL(url, this.server), {\n\t\t\t\tsignal: this.signal,\n\t\t\t});\n\n\t\t\tif (request.status === 200) {\n\t\t\t\treturn await request.text();\n\t\t\t} else {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`unexpected server response to not match \"200\". Server says \"${await request.text()}\"`\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tthrow new Error('Cannot communicate with the server');\n\t\t}\n\t}\n\tasync needPassword() {\n\t\treturn (await this.get('needpassword')) === 'true';\n\t}\n\tasync newSession() {\n\t\treturn await this.get('newsession');\n\t}\n\tasync editSession(\n\t\tid: string,\n\t\thttpProxy: string | false,\n\t\tenableShuffling: boolean\n\t) {\n\t\tconst res = await this.get(\n\t\t\t'editsession?id=' +\n\t\t\t\tencodeURIComponent(id) +\n\t\t\t\t(httpProxy ? '&httpProxy=' + encodeURIComponent(httpProxy) : '') +\n\t\t\t\t'&enableShuffling=' +\n\t\t\t\t(enableShuffling ? '1' : '0')\n\t\t);\n\n\t\tif (res !== 'Success') {\n\t\t\tthrow new Error(`unexpected response from server. received ${res}`);\n\t\t}\n\t}\n\tasync sessionExists(id: string) {\n\t\tconst res = await this.get('sessionexists?id=' + encodeURIComponent(id));\n\n\t\tswitch (res) {\n\t\t\tcase 'exists':\n\t\t\t\treturn true;\n\t\t\tcase 'not found':\n\t\t\t\treturn false;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`unexpected response from server. received ${res}`);\n\t\t}\n\t}\n\tasync deleteSession(id: string) {\n\t\tif (await this.sessionExists(id)) {\n\t\t\tconst res = await this.get('deletesession?id=' + id);\n\n\t\t\tif (res !== 'Success' && res !== 'not found') {\n\t\t\t\tthrow new Error(`unexpected response from server. received ${res}`);\n\t\t\t}\n\t\t}\n\t}\n\tasync shuffleDict(id: string) {\n\t\tconst res = await this.get('api/shuffleDict?id=' + encodeURIComponent(id));\n\t\treturn JSON.parse(res);\n\t}\n}\n\nexport class StrShuffler {\n\tprivate dictionary: string;\n\tbaseDictionary =\n\t\t'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~-';\n\tshuffledIndicator = '_rhs';\n\tconstructor(dictionary?: string) {\n\t\tdictionary ||= this.generateDictionary();\n\t\tthis.dictionary = dictionary;\n\t}\n\tmod(n: number, m: number) {\n\t\treturn ((n % m) + m) % m;\n\t}\n\tgenerateDictionary() {\n\t\tlet str = '';\n\t\tconst split = this.baseDictionary.split('');\n\t\twhile (split.length > 0)\n\t\t\tstr += split.splice(Math.floor(Math.random() * split.length), 1)[0];\n\n\t\treturn str;\n\t}\n\tshuffle(str: string) {\n\t\tif (str.startsWith(this.shuffledIndicator)) return str;\n\t\tlet shuffledStr = '';\n\t\tfor (let i = 0; i < str.length; i++) {\n\t\t\tconst char = str.charAt(i);\n\t\t\tconst idx = this.baseDictionary.indexOf(char);\n\t\t\tif (char === '%' && str.length - i >= 3) {\n\t\t\t\tshuffledStr += char;\n\t\t\t\tshuffledStr += str.charAt(++i);\n\t\t\t\tshuffledStr += str.charAt(++i);\n\t\t\t} else if (idx === -1) shuffledStr += char;\n\t\t\telse\n\t\t\t\tshuffledStr += this.dictionary.charAt(\n\t\t\t\t\tthis.mod(idx + i, this.baseDictionary.length)\n\t\t\t\t);\n\t\t}\n\t\treturn this.shuffledIndicator + shuffledStr;\n\t}\n\tunshuffle(str: string) {\n\t\tif (!str.startsWith(this.shuffledIndicator)) return str;\n\n\t\tstr = str.slice(this.shuffledIndicator.length);\n\n\t\tlet unshuffledStr = '';\n\t\tfor (let i = 0; i < str.length; i++) {\n\t\t\tconst char = str.charAt(i);\n\t\t\tconst idx = this.dictionary.indexOf(char);\n\t\t\tif (char === '%' && str.length - i >= 3) {\n\t\t\t\tunshuffledStr += char;\n\t\t\t\tunshuffledStr += str.charAt(++i);\n\t\t\t\tunshuffledStr += str.charAt(++i);\n\t\t\t} else if (idx === -1) unshuffledStr += char;\n\t\t\telse\n\t\t\t\tunshuffledStr += this.baseDictionary.charAt(\n\t\t\t\t\tthis.mod(idx - i, this.baseDictionary.length)\n\t\t\t\t);\n\t\t}\n\t\treturn unshuffledStr;\n\t}\n}\n","/*! js-cookie v3.0.1 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (key, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    key = encodeURIComponent(key)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      key + '=' + converter.write(value, key) + stringifiedAttributes)\n  }\n\n  function get (key) {\n    if (typeof document === 'undefined' || (arguments.length && !key)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var foundKey = decodeURIComponent(parts[0]);\n        jar[foundKey] = converter.read(value, foundKey);\n\n        if (key === foundKey) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return key ? jar[key] : jar\n  }\n\n  return Object.create(\n    {\n      set: set,\n      get: get,\n      remove: function (key, attributes) {\n        set(\n          key,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport default api;\n","import type { HolyPage } from '../../App';\nimport { getDestination } from '../../CompatLayout';\nimport { RammerheadAPI, StrShuffler } from '../../RammerheadAPI';\nimport { RH_API } from '../../consts';\nimport i18n from '../../i18n';\nimport Cookies from 'js-cookie';\nimport { useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useLocation } from 'react-router-dom';\n\nfunction patch(url: string) {\n\t// url = _rhsEPrcb://bqhQko.tHR/\n\t// remove slash\n\treturn url.replace(/(^.*?:\\/)\\//, '$1');\n}\n\nconst Rammerhead: HolyPage = ({ compatLayout }) => {\n\tconst { t } = useTranslation('compat');\n\tconst location = useLocation();\n\n\tuseEffect(() => {\n\t\t(async function () {\n\t\t\tlet errorCause: string | undefined;\n\n\t\t\ttry {\n\t\t\t\tconst api = new RammerheadAPI(RH_API);\n\n\t\t\t\t// according to our NGINX config\n\t\t\t\tif (process.env.NODE_ENV === 'production') {\n\t\t\t\t\tCookies.set('auth_proxy', '1', {\n\t\t\t\t\t\tdomain: `.${global.location.host}`,\n\t\t\t\t\t\texpires: 1000 * 60 * 60 * 24 * 7, // 1 week\n\t\t\t\t\t\tsecure: global.location.protocol === 'https:',\n\t\t\t\t\t\tsameSite: 'lax',\n\t\t\t\t\t});\n\n\t\t\t\t\tCookies.set('origin_proxy', global.location.origin, {\n\t\t\t\t\t\texpires: 1000 * 60 * 60 * 24 * 7, // 1 week\n\t\t\t\t\t\tsecure: global.location.protocol === 'https:',\n\t\t\t\t\t\tsameSite: 'lax',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\terrorCause = i18n.t('compat:error.unreachable', { what: 'Rammerhead' });\n\t\t\t\tawait fetch(RH_API);\n\t\t\t\terrorCause = undefined;\n\n\t\t\t\terrorCause = i18n.t('compat:error.rammerheadSavedSession');\n\n\t\t\t\tif (\n\t\t\t\t\tlocalStorage.rammerhead_session &&\n\t\t\t\t\t(await api.sessionExists(localStorage.rammerhead_session))\n\t\t\t\t) {\n\t\t\t\t\tconst test = await fetch(\n\t\t\t\t\t\tnew URL(localStorage.rammerhead_session, RH_API)\n\t\t\t\t\t);\n\n\t\t\t\t\tawait api.deleteSession(localStorage.rammerhead_session);\n\n\t\t\t\t\t// 404 = good, 403 = Sessions must come from the same IP\n\t\t\t\t\tif (test.status === 403) delete localStorage.rammerhead_session;\n\t\t\t\t} else {\n\t\t\t\t\tdelete localStorage.rammerhead_session;\n\t\t\t\t}\n\n\t\t\t\terrorCause = i18n.t('compat:error.rammerheadNewSession');\n\t\t\t\tconst session =\n\t\t\t\t\tlocalStorage.rammerhead_session || (await api.newSession());\n\t\t\t\terrorCause = undefined;\n\n\t\t\t\terrorCause = undefined;\n\n\t\t\t\terrorCause = i18n.t('compat:error.rammerheadEditSession');\n\t\t\t\tawait api.editSession(session, false, true);\n\t\t\t\terrorCause = undefined;\n\n\t\t\t\terrorCause = i18n.t('compat:error.rammerheadDict');\n\t\t\t\tconst dict = await api.shuffleDict(session);\n\t\t\t\terrorCause = undefined;\n\n\t\t\t\tconst shuffler = new StrShuffler(dict);\n\n\t\t\t\tglobal.location.replace(\n\t\t\t\t\tnew URL(\n\t\t\t\t\t\t`${session}/${patch(shuffler.shuffle(getDestination(location)))}`,\n\t\t\t\t\t\tRH_API\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} catch (err) {\n\t\t\t\tcompatLayout.current!.report(err, errorCause, 'Rammerhead');\n\t\t\t}\n\t\t})();\n\t}, [compatLayout, location]);\n\n\treturn <main>{t('loading', { what: 'Rammerhead' })}</main>;\n};\n\nexport default Rammerhead;\n"],"names":["RammerheadAPI","url","password","includes","request","fetch","URL","server","signal","status","text","err","console","error","get","id","httpProxy","enableShuffling","res","encodeURIComponent","sessionExists","JSON","parse","constructor","StrShuffler","mod","n","m","generateDictionary","str","split","baseDictionary","length","splice","Math","floor","random","shuffle","startsWith","shuffledIndicator","shuffledStr","i","char","charAt","idx","indexOf","dictionary","unshuffle","slice","unshuffledStr","assign","target","arguments","source","key","api","init","converter","defaultAttributes","set","value","attributes","document","expires","Date","now","toUTCString","replace","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","write","Object","create","cookies","jar","parts","join","foundKey","read","e","remove","withAttributes","withConverter","freeze","path","Rammerhead","compatLayout","t","useTranslation","location","useLocation","useEffect","errorCause","RH_API","Cookies","domain","global","host","secure","protocol","sameSite","origin","i18n","what","undefined","localStorage","rammerhead_session","test","deleteSession","session","newSession","editSession","dict","shuffleDict","shuffler","getDestination","current","report","main"],"sourceRoot":""}