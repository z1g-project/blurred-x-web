{"version":3,"file":"static/js/274.73e4bd15.chunk.js","mappings":"wMACA,EAAe,CAAC,KAAO,yBAAyB,E,6BCoBhD,IAAMA,EAAkB,CAAC,CAAEC,aAAAA,CAAY,CAAE,GAAK,CAC7C,GAAM,CAAEC,EAAAA,CAAC,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,EAAAA,EAAe,UACvBC,EAAWC,CAAAA,EAAAA,EAAAA,EAAAA,IACXC,EAAYC,CAAAA,EAAAA,EAAAA,MAAAA,EAA2B,IAAI,EAC3CC,EAAeD,CAAAA,EAAAA,EAAAA,MAAAA,EAAyB,IAAI,EAC5C,CAACE,EAAcC,EAAgB,CAAGC,CAAAA,EAAAA,EAAAA,QAAAA,EAAS,IAwCjD,MAtCAC,CAAAA,EAAAA,EAAAA,SAAAA,EAAU,IAAM,CACf,IAAIC,EAgCJ,MA9BA,CAAC,EAAD,KAAC,WAAkB,KAGdC,EAFJ,GAAI,EAAcC,OAAO,EAAKT,EAAUS,OAAO,CAI/C,GAAI,CACHD,EAAaE,EAAAA,EAAAA,CAAAA,CAAM,CAAC,wBACpB,MAAMR,EAAaO,OAAO,CAACE,OAAO,CAClCH,EAAaI,KAAAA,EAEb,IAAMC,EAASC,aAAaC,MAAM,GAClCR,EAASM,EAAOG,YAAY,GAC5BhB,EAAUS,OAAO,CAACQ,MAAM,CAACV,GAEzBA,EAAOW,gBAAgB,CAAC,aAAc,IAAM,CAC3Cd,EAAgB,GACjB,GAEAG,EAAOW,gBAAgB,CAAC,QAAS,GAAW,CAC3C,MAAMC,EAAMC,KAAK,GAGlBb,EAAOc,IAAI,CAAC,CACXC,IAAKC,CAAAA,EAAAA,EAAAA,EAAAA,EAAezB,EACrB,EACD,CAAE,MAAO0B,EAAK,CACb7B,EAAac,OAAO,CAAEgB,MAAM,CAACD,EAAKhB,EAAY,aAC/C,CAxBA,KA2BM,IAAM,CACZD,MAAAA,GAAAA,EAAQmB,MAAM,EACf,CACD,EAAG,CAAC/B,EAAcG,EAAUI,EAAa,EAGxC,WAACyB,OAAAA,CACAC,UAAWC,EAAAA,IAAW,CACtBC,cAAaC,OAAO5B,GACpB6B,IAAKhC,EAAAA,SAAAA,CAEL,UAACiC,EAAAA,EAAMA,CAAAA,CAACC,IAAKC,EAAAA,EAAWA,CAAG,oBAAqBH,IAAK9B,CAAY,GAChE,CAACC,GAAgBP,EAAE,UAAW,CAAEwC,KAAM,cAAe,KAGzD,EAEA,MAAe1C,C","sources":["webpack://website/./src/styles/CompatFlash.module.scss","webpack://website/./src/pages/compat/flash.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"main\":\"CompatFlash_main__el4-l\"};","import type { HolyPage } from '../../App';\nimport type { ScriptRef } from '../../CompatLayout';\nimport { getDestination, Script } from '../../CompatLayout';\nimport i18n from '../../i18n';\nimport { PUBLIC_PATH } from '../../routes';\nimport styles from '../../styles/CompatFlash.module.scss';\nimport { useEffect, useRef, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useLocation } from 'react-router-dom';\n\ninterface RufflePlayerElement extends HTMLElement {\n\tload(data: { url: string }): void;\n\tremove(): void;\n}\n\ndeclare const RufflePlayer: {\n\tnewest(): {\n\t\tcreatePlayer(): RufflePlayerElement;\n\t};\n};\n\nconst Flash: HolyPage = ({ compatLayout }) => {\n\tconst { t } = useTranslation('compat');\n\tconst location = useLocation();\n\tconst container = useRef<HTMLElement | null>(null);\n\tconst ruffleBundle = useRef<ScriptRef | null>(null);\n\tconst [ruffleLoaded, setRuffleLoaded] = useState(false);\n\n\tuseEffect(() => {\n\t\tlet player: RufflePlayerElement | undefined;\n\n\t\t(async function () {\n\t\t\tif (!ruffleBundle.current || !container.current) return;\n\n\t\t\tlet errorCause: string | undefined;\n\n\t\t\ttry {\n\t\t\t\terrorCause = i18n.t('compat:error.generic');\n\t\t\t\tawait ruffleBundle.current.promise;\n\t\t\t\terrorCause = undefined;\n\n\t\t\t\tconst ruffle = RufflePlayer.newest();\n\t\t\t\tplayer = ruffle.createPlayer();\n\t\t\t\tcontainer.current.append(player);\n\n\t\t\t\tplayer.addEventListener('loadeddata', () => {\n\t\t\t\t\tsetRuffleLoaded(true);\n\t\t\t\t});\n\n\t\t\t\tplayer.addEventListener('error', (event) => {\n\t\t\t\t\tthrow event.error;\n\t\t\t\t});\n\n\t\t\t\tplayer.load({\n\t\t\t\t\turl: getDestination(location),\n\t\t\t\t});\n\t\t\t} catch (err) {\n\t\t\t\tcompatLayout.current!.report(err, errorCause, 'Rammerhead');\n\t\t\t}\n\t\t})();\n\n\t\treturn () => {\n\t\t\tplayer?.remove();\n\t\t};\n\t}, [compatLayout, location, ruffleBundle]);\n\n\treturn (\n\t\t<main\n\t\t\tclassName={styles.main}\n\t\t\tdata-loaded={Number(ruffleLoaded)}\n\t\t\tref={container}\n\t\t>\n\t\t\t<Script src={PUBLIC_PATH + '/ruffle/ruffle.js'} ref={ruffleBundle} />\n\t\t\t{!ruffleLoaded && t('loading', { what: 'Flash Player' })}\n\t\t</main>\n\t);\n};\n\nexport default Flash;\n"],"names":["Flash","compatLayout","t","useTranslation","location","useLocation","container","useRef","ruffleBundle","ruffleLoaded","setRuffleLoaded","useState","useEffect","player","errorCause","current","i18n","promise","undefined","ruffle","RufflePlayer","newest","createPlayer","append","addEventListener","event","error","load","url","getDestination","err","report","remove","main","className","styles","data-loaded","Number","ref","Script","src","PUBLIC_PATH","what"],"sourceRoot":""}